## 우아한 테크러닝 React&Typescript 3회차

2020년 09월 08일 화요일

<details><summary>📖 Table of Contents</summary>

- [JavaScript 함수](#javascript-함수)

  - [JavaScript 함수의 정의](#javascript-함수의-정의)

- [Reference Link](#Reference-Link)

</details>

## 오늘의 주제

- React 를 직접 만들어 보자 (VDOM 까지)

## React 가 해결하고자 하는 문제점

```javascript
const list = [
  { title: "React에 대해 알아봅시다." },
  { title: "Redux에 대해 알아봅시다." },
  { title: "Typescript에 대해 알아봅시다." },
];
```

위와 같은 `list` 데이터를 JS 로 화면에 그리는 방법은 아래와 같다.

```javascript
const rootElement = document.getElementById("root");

function app(items) {
  rootElement.innerHTML = `
        <ul>
            ${items.map((item) => `<li>${item.title}</li>`).join("")}
        </ul>
    `;
}

app(list);
```

매개변수로 `items` 데이터를 넣어줘 함수의 외부 참조를 제거 했다. - **순수 함수(pure function) 형태로 만듬**

하지만 위의 `app`함수는 `innerHTML` 같이 `DOM`에 직접 접근해 구조를 변경하고 있다.

- 직접 `DOM` 을 조작하는 것의 문제점

`Real DOM` 의 API 들은 대부분 너무 low 한 level 을 다루는 로직들이다. 즉, 규모가 큰 앱에서 `Real DOM` 을 많이 조작하다보면 앱의 복잡도가 너무 높아진다. (예, JQuery)

이러한 문제를 해결하기 위해서 *Facebook*이 `React`라는 라이브러리를 개발하게 되었다.  
브라우저는 `HTML`이라는 텍스트 데이터를 `DOM`이라는 트리 구조의 데이터로 변환해 관리한다.
`React`는 `DOM`을 조금 더 간단한 형태인 `Virtual DOM`(VDOM)으로 변환해 개발자가 간편히 사용할 수 있도록 개발했다.

> 브라우저가 html 을 쉽게 다루기 위해 DOM 을 개발한 것과  
> DOM 을 쉽게 다루기 위해 VDOM 을 개발한 것은
> 비슷한 방식의 엔지니어링 컨셉이다.
>
> - HTML 태그 (string) -> DOM -> Browser
> - JS -> VDOM -> DOM
>
> 이러한 엔지니어링 방식은 다양한 분야에서 흔히 쓰이는 방식이다.

## React 와 Virtual DOM 이해하기

React 컴포넌트의 기본적인 구조는 아래와 같다.

```javascript
import React from "react";
import ReactDOM from "react-dom";

function StudyList(props) {
  return (
    <ul>
      <li className="item">React</li>
      <li className="item">Redux</li>
      <li className="item">MobX</li>
      <li className="item">Typescript</li>
    </ul>
  );
}

function App() {
  return (
    <div>
      <h1>Hello?</h1>
      <StudyList item="abcd" id="hoho" />
    </div>
  );
}

ReactDOM.render(<App />, document.getElementById("root"));
```

`ReactDOM`은 `render`라는 **정적메서드**를 가지며 2개의 인자를 받는다. 첫 번째 인자는 화면에 렌더링할 컴포넌트이며 두 번째는 컴포넌트를 렌더링할 부모 요소다.

위의 `StudyList` 함수에서 반환하는 `JSX` 를 객체로 transpile 해 표현하면 아래와 같다.

```javascript
const vdom = {
  type: "ul",
  props: {item: "abcd" id: "hoho"},
  children: [
    { type: "li", props: { className: "item" }, children: "React" },
    { type: "li", props: { className: "item" }, children: "Redux" },
    { type: "li", props: { className: "item" }, children: "Typescript" },
    { type: "li", props: { className: "item" }, children: "MobX" },
  ],
};
```

위와 같이 생성된 객체를 `ReactDom.render` 메서드가 실제 `HTML` 태그로 변경시켜 화면에 그려준다.

이 객체가 바로 `Virtual DOM` 이다.
`React`는 `vdom` 트리의 최상위에 단 하나의 부모를 가진다.

## React 를 학습하며 고민해볼 점

- 어떤 구조로 설계하면 좋은가?

  좋은 설계의 원칙 : **같은 것끼리 묶고 다른 것은 분리한다**

- React 코드의 구조적 장점?

  > 기본적으로 코드의 구조는 **Naming** 만 잘 해줘도 반은 먹고 들어간다.

  너무 일반적이라 한 눈에 구조를 알아보기 힘든 **HTML Tag** 들을 **컴포넌트로 묶어 Naming 할 수 있는 React 의 구조**로 인해 많은 이점이 있다.

- **compile 타임** 과 **run 타임** 에 일어나는 일 각각 구분

- **transpiler 가 하는 일** / **React 가 하는 일** 구분

## React 뜯어보기

- `React.createElement`  
  jsx 를 Tree 구조의 VDOM 을 만드는 함수

- `ReactDOM.render`  
  Virtual DOM 을 Real DOM 에 옮겨주는 함수

- `jsx` 는 `React.creactElement` 를 호출하는 요소이다. (transpiler 가 담당)

- 컴포넌트 이름의 첫 글자를 **대문자**로 쓰도록 강제하는 이유

  : Babel 에서 jsx 를 compile 할 때 **소문자는 문자열로 인식**해 HTML Tag 로 transpile 하고 **대문자는 Function 으로 인식**하도록 되어 있음 (이처럼 단순한 개념으로 jsx 를 React 컴포넌트와 혼용해 사용할 수 있게 되었다.)

- Hook 원리

  전역 변수에 배열을 생성하고 VDOM 에서 컴포넌트가 `render` 되는 순서를 해당 배열의 index 순서로 삼아 React 컴포넌트 별로 호출된 hook 들의 정보를 담는다.

## Reference Link

- [참고 정리 page](https://github.com/textuel/Woowa_Tech_Learning_React_Typescript/blob/master/ms/week_2/Tuesday.md)

- [/\*_ @jsx createElement _/ 의 역할 참고](https://stackoverflow.com/questions/53803466/what-does-the-comment-jsx-jsx-do-in-the-emotion-css-in-js-library)

- [강사님 코드](https://gist.github.com/ibare/c736f63fba835c172e60aa98a996dada)
