## ìš°ì•„í•œ í…Œí¬ëŸ¬ë‹ React&Typescript 6íšŒì°¨

2020ë…„ 09ì›” 17ì¼ ëª©ìš”ì¼

<details><summary>ğŸ“– Table of Contents</summary>

- [Webpack](#Webpack)

  - [Webpack - Loader](#Webpack---Loader)

  - [Webpack - Plugin](#Webpack---Plugin)

- [React & TypeScript](#React-&-TypeScript)

  - [ë¦¬ë•ìŠ¤ ì‚¬ê°€ì˜ Effects ì¢…ë¥˜](#ë¦¬ë•ìŠ¤-ì‚¬ê°€ì˜-Effects-ì¢…ë¥˜)

  - [ì‹¤ì œ App ë³´ê¸°](#ì‹¤ì œ-App-ë³´ê¸°)

- [Reference Link](#Reference-Link)

</details>

## ì˜¤ëŠ˜ì˜ ì£¼ì œ

- Webpack ì— ëŒ€í•´ ê°„ë‹¨íˆ ì‚´í´ë³´ì

- React + TypeScript App ì•ˆì—ì„œ Redux Saga ë¥¼ ì´í•´í•´ë³´ì

## Webpack

[TypeScript + React - boiler plate (ê°•ì‚¬ë‹˜ ì œê³µ)](https://github.com/ibare/tech-learning-3rd-webpack) (`webpack.config.js` ì°¸ê³ )

- `webpack` ì€ ì•„ì£¼ ê±°ëŒ€í•œ í”Œë«í¼ì´ë¼ ë³¼ ìˆ˜ ìˆë‹¤.
- ì„¤ì •ì´ ê½¤ ê¹Œë‹¤ë¡­ê³ , ë²„ì „ ì˜ì¡´ì„± ë“± ë‹¤ì–‘í•œ ë³µì¡ì„±ì´ ì¡´ì¬í•œë‹¤.
- `webpack`ì€ ì¼ë°˜ì ìœ¼ë¡œ `webpack.config.js`ë¼ëŠ” ì´ë¦„ì„ ê°–ëŠ” ì„¤ì • íŒŒì¼ì„ ê°–ëŠ”ë‹¤. (ì„¤ì • ë¶€ë¶„ ë³„ë¡œ íŒŒì¼ì„ ë‚˜ëˆ„ê¸°ë„ í•œë‹¤.)
- `webpack`ì€ `node`ì—ì„œ ì‹¤í–‰ë˜ë©° ì‘ì„±í•œ ì„¤ì • ê°’ì„ ë‹´ì€ ê°ì²´ì„ ì½ì–´ ì²˜ë¦¬í•˜ê²Œ ëœë‹¤.

```javascript
const webpack = require("webpack");
const path = require("path");
const HtmlWebpackPlugin = require("html-webpack-plugin");
const { CleanWebpackPlugin } = require("clean-webpack-plugin");
const { TsconfigPathsPlugin } = require("tsconfig-paths-webpack-plugin");
```

`node`ì—ì„œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— **ëª¨ë“ˆ**ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ìœ„ì™€ ê°™ì´ `require`ë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.<br/>
ì„¤ì • ê°’ì„ ë‹´ì€ ê°ì²´ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ `config` ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ëª¨ë“ˆë¡œ ë‚´ë³´ë‚¸ë‹¤.<br/>

```javascript
const config = {};

module.exports = config;
```

`entry`ëŠ” `webpack` ì‹¤í–‰ ì‹œ ì§„ì…ì ì„ ê°€ë¦¬í‚¤ëŠ” íŒŒì¼ì„ ì˜ë¯¸í•œë‹¤.<br/>
`core-js`ëŠ” **polyfill** ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë©° í•˜ìœ„ ë¸Œë¼ìš°ì €ì˜ ë¬¸ë²•ê³¼ ê´€ë ¨ í˜¸í™˜ì„±ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.<br/>

```javascript
const config = {
  // ...
  entry: {
    main: ["core-js", "./src/index.tsx"],
  },
  // ...
};
```

`webpack`ì€ êµ‰ì¥íˆ ê±°ëŒ€í•˜ì§€ë§Œ `webpack`ì´ í•´ì£¼ëŠ” ì¼ì€ ê·¸ë ‡ê²Œ ë§ì§€ ì•Šë‹¤.<br/>

### Webpack - Loader

[ê³µì‹ doc ë§í¬](https://webpack.js.org/contribute/writing-a-loader/)

- `webpack` ì˜ `Middleware` ì´ë‹¤.
- ë§¤ìš° ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ `Loader` ê°€ ìˆë‹¤.
- `Loader`ì˜ ì£¼ ì—­í• ì€ Converting ì´ë‹¤.

```javascript
  entry: {
    main: ["core-js", `./src/index.tsx`]
  },
```

ìœ„ ì„¤ì •ì—ì„œ `index.tsx` (entry) ë¥¼ ì‹œì‘ìœ¼ë¡œ import ëœ íŒŒì¼ë“¤ì„ ì½ì–´ `Loader` ì— ë„˜ê²¨ì§€ë©° ê°ê°ì˜ `Loader` ê°€ ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.

`Loader`ëŠ” ì„¤ì • íŒŒì¼ì˜ `module` ì†ì„±ì— ì‘ì„±ë˜ë©° `rules` ë°°ì—´ì— ì•„ë˜ì™€ ê°™ì´ ê¸°ìˆ ëœë‹¤.<br/>

```javascript
  module: {
    rules: [
      {
        test: /\.(ts|js)x?$/,
        include: path.resolve("src"),
        exclude: /node_modules/,
        use: {
          loader: "babel-loader"
        }
      },
      {
        test: /\.(png|svg|jpg|gif)$/,
        loader: "file-loader",
        options: {
          name: "[name].[ext]",
          outputPath: "./images/"
        }
      }
    ]
  },
```

ìœ„ ì„¤ì •ì—ì„œ `rules` ë°°ì—´ì„ ëŒë©° `test` ì˜ ê°’ (í™•ì¥ì)ì— í•´ë‹¹í•˜ëŠ” íŒŒì¼ì„ ëª…ì‹œëœ `Loader` ì— ë„˜ê²¨ì¤€ë‹¤.

> `Typescript`ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” `ts-loader`ê°™ì€ `loader`ë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ í˜„ì¬ëŠ” `babel`ì´ ì§€ì›í•œë‹¤.<br/>

### Webpack - Plugin

[ê³µì‹ doc ë§í¬](https://webpack.js.org/contribute/writing-a-plugin/)

- ì£¼ë¡œ `Loader` ê°€ ëª¨ë‘ ì‹¤í–‰ëœ í›„ ê·¸ ê²°ê³¼ë¬¼ì„ ë°›ì•„ì„œ ì²˜ë¦¬í•œë‹¤. **(í›„ì²˜ë¦¬)**
- `Plugin`ì€ `Loader`ë³´ë‹¤ ë” ë³µì¡í•˜ë©° í›¨ì”¬ ë” ë§ì€ ì¼ì„ í•  ìˆ˜ ìˆë‹¤.<br/>
- `plugin`ì€ `webpack` ì„¤ì • ê°ì²´ì˜ `plugins` ë°°ì—´ì— ì§€ì •í•œë‹¤.<br/>

```javascript
plugins: [
    new webpack.SourceMapDevToolPlugin({}),
    new CleanWebpackPlugin(),

    // HTML ìƒì„±í•˜ëŠ” í”ŒëŸ¬ê·¸ì¸
    new HtmlWebpackPlugin({
      template: path.resolve(__dirname, "public/index.html")
    }),

    // í™˜ê²½ë³€ìˆ˜ ì£¼ì… í”ŒëŸ¬ê·¸ì¸
    new webpack.DefinePlugin({
      "process.env.NODE_ENV": JSON.stringify(process.env.NODE_ENV)
    })
  ],
```

- `console.log` ë¬¸ ì‚­ì œ / ì•”í˜¸í™” ë“±ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì˜ Plugin ì´ ì¡´ì¬í•œë‹¤.

- `Babel` ë˜í•œ ë§¤ìš° ë§ì€ `plugin` ì„ ê°€ì§€ê³  ìˆë‹¤.

  - `.babelrc`

    `Babel` ì—ì„œëŠ” ES6+ ì˜ ë¬¸ë²•ë“¤ ê°ê°ì„ tranpile í•˜ëŠ” `Plugin` ì´ ë”°ë¡œ ì¡´ì¬í•œë‹¤.

    ```javascript
    "plugins": [
        "@loadable/babel-plugin",
        "babel-plugin-styled-components",
        [
          "@babel/transform-runtime",
          {
            "corejs": 3
          }
        ],
        "@babel/plugin-proposal-optional-chaining",
        [
          "@babel/plugin-proposal-decorators",
          {
            "legacy": true
          }
        ],
        "@babel/plugin-proposal-class-properties",
        "@babel/plugin-transform-exponentiation-operator",
        "@babel/proposal-object-rest-spread",
        "@babel/plugin-transform-async-to-generator"
      ]
    ```

> Webpack ì™¸ì— **Parcel** ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. (`Parcel`ì´ ì„¤ì •ì€ í›¨ì”¬ ê°„ë‹¨)

## React & TypeScript

### ë¦¬ë•ìŠ¤ ì‚¬ê°€ì˜ Effects ì¢…ë¥˜

- `Fork()`

  ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ëœ í•¨ìˆ˜ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤. ë¹„ë™ê¸°ë€ ì‰½ê²Œ ë§í•˜ë©´ê·¸ í•¨ìˆ˜ë¥¼ ëˆ„êµ°ê°€ì—ê²Œ ëŒ€ì‹  ì‹¤í–‰í•˜ê²Œ ë§¡ê¸°ê³  ë‚˜ëŠ” ë‹¤ë¥¸ì¼ì„ í•˜ëŸ¬ ë– ë‚˜ëŠ” ê²ƒì´ë‹¤.

- `call()`

  `Fork()`ê°€ í•¨ìˆ˜ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤ê³  í•˜ë©´, `Call()`ì€ í•¨ìˆ˜ë¥¼ ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤. `Call`ì— ë„˜ê²¨ì§„ í•¨ìˆ˜ê°€ `Promise`ë¥¼ ë¦¬í„´í•˜ë©´ ê·¸ `Promise`ê°€ `resolved` ë  ë•Œê¹Œì§€ `call()`ì„ í˜¸ì¶œí•œ ë¶€ë¶„ì—ì„œ ì‹¤í–‰ì´ ë©ˆì¶˜ë‹¤.

  `Promise` ë¥¼ `return` í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ í˜¸ì¶œí•œë‹¤.

- `Take()`

  ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ëœ ì•¡ì…˜ì´ ì˜¬ë•Œê¹Œì§€ ë¸”ë½ëœ ìƒíƒœë¡œ ê¸°ë‹¤ë¦°ë‹¤.

- `takeLatest()`

  ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì¸ ì•¡ì…˜ì´ ìˆì„ ë•Œ, ìƒˆë¡œìš´ ì•¡ì…˜ì´ `dispatch` ë˜ë©´ ê³§ ë°”ë¡œ ê¸°ì¡´ ì•¡ì…˜ ì²˜ë¦¬ë¥¼ ì·¨ì†Œí•˜ê³  ê°€ì¥ ë§ˆì§€ë§‰ì— `dispatch` ëœ ì•¡ì…˜ë§Œ ì²˜ë¦¬í•œë‹¤. (`debounce`, `throttling` ë¥¼ í¸í•˜ê²Œ ì‚¬ìš©í•˜ëŠ” ê°œë…ì„)

  íŠ¹íˆ AJAX request ì— ìœ ìš©í•˜ë‹¤.

- `Race()`

  `effects` ë“¤ì„ ë§ˆì¹˜ ê²½ì£¼í•˜ë“¯ì´ ë™ì‹œì— ì‹¤í–‰ì‹œì¼œë†“ê³  ë¨¼ì € ì™„ë£Œë˜ëŠ”ì• ê°€ ìˆìœ¼ë©´ ë‹¤ë¥¸ `effects`ë“¤ì„ ì¢…ë£Œì‹œì¼œë²„ë¦°ë‹¤.

- `Put()`

  ì•¡ì…˜ì„ `dispatch` í•©ë‹ˆë‹¤. ë³´í†µ `take()`ë¡œ ì•¡ì…˜ì„ ìºì¹˜í•´ì„œ `call()`ë¡œ api í˜¸ì¶œì„ ì‹¤í–‰í•˜ê³  ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ì— ë”°ë¼ ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ì— ë°˜ì˜í•˜ê¸° ìœ„í•´ì„œ í˜¸ì¶œí•˜ëŠ” Effects ì´ë‹¤.

- `Select()`

  `Redux` `State` ì—ì„œ ë°ì´í„°ë¥¼ êº¼ë‚´ì˜¤ê¸° ìœ„í•œ í•¨ìˆ˜ì´ë‹¤.  
  `getState` ì™€ ê°™ìŒ

- `takeLatest`

  ê°€ì¥ ë§ˆì§€ë§‰ì—(ìµœê·¼) ì‹¤í–‰ëœ ì•¡ì…˜ì— ëŒ€í•´ì„œë§Œ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤.

- `takeEvery`

  ìºì¹˜ëœ ëª¨ë“  ì•¡ì…˜ì— ëŒ€í•´ì„œ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤.

- `all([])`

  ë°°ì—´ ë‚´ì˜ `call()` ë“¤ì„ ë³‘ë ¬ì ìœ¼ë¡œ (ë™ì‹œì—) ì‹¤í–‰í•œë‹¤.

### ì‹¤ì œ App ë³´ê¸°

- [ê°•ì‚¬ë‹˜ ì½”ë“œ](https://codesandbox.io/s/ordermonitor04-gangsanim-8izj4)
- [ë‚˜ì˜ ì½”ë“œ (Clon Codded)](https://codesandbox.io/s/ordermonitor04-na-q81ke)

- ì¤‘ìš” ì½”ë“œ (Redux Saga)

  - `/sagas/index.tsx`

  ```javascript
  import { fork, all, take, race, delay, put } from "redux-saga/effects";
  import { getType } from "typesafe-actions";
  import * as Actions from "../actions";

  function* monitoringWorkflow() {
    while (true) {
      console.log("ì‹œì‘ë¨");
      yield take(getType(Actions.startMonitoring));
      // action type (ë¬¸ìì—´) ì„ ë°›ì•„ì„œ Saga ì—ê²Œ í•´ë‹¹ ë¬¸ìì—´ì´ ë“¤ì–´ì˜¤ë©´ next ë¥¼ í˜¸ì¶œí•˜ë¼ëŠ” ì˜ë¯¸
      // ì¦‰, í•´ë‹¹ action ì´ ì˜¬ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
      console.log("Action ë°›ìŒ");

      let loop = true;

      while (loop) {
        yield all([
          put({ type: getType(Actions.fetchSuccess) }),
          put({ type: getType(Actions.fetchFailure) }),
        ]);
        // all : ë‹¤ìˆ˜ì˜ put ì„ ë¬¶ì–´ í•œë²ˆì— saga ì—ê²Œ ë³´ë‚´ì¤Œ
        // put : action dispatch

        const { stopped } = yield race({
          waiting: delay(200),
          stopped: take(getType(Actions.stopMonitoring)),
        });
        // race : effect ë“¤ì„ ê²½ì£¼í•˜ë“¯ ë™ì‹œì— ì‹¤í–‰ì‹œì¼œ
        // ë¨¼ì € ì™„ë£Œë˜ëŠ” ê²ƒì´ ìˆìœ¼ë©´ ë‹¤ë¥¸ effect ëŠ” ì¢…ë£Œì‹œí‚´
        // ì¦‰, ìœ„ ì½”ë“œì—ì„  200/1000 ì´ˆì™€ stopMonitoring action ì´ ë“¤ì–´ì™”ëŠ”ì§€ë¥¼ ê²½ì£¼ì‹œí‚´
        //     stopMonitoring action ì´ ë“¤ì–´ì˜¤ë©´ stopped = true

        if (stopped) loop = false; // stopped ê°’ ìˆìœ¼ë©´ loop ì¢…ë£Œ
      }
    }
  }

  export default function* () {
    yield fork(monitoringWorkflow);
    // fork : ë¹„ë™ê¸° ì‹¤í–‰
  }
  // export defaultë¡œ ë‚´ë³´ë‚¸ ì œë„ˆë ˆì´í„°ëŠ” redux-saga ë¯¸ë“¤ì›¨ì–´ì˜ run ë©”ì„œë“œì— ì „ë‹¬ëœë‹¤. (src/index.tsx)
  ```

## Reference Link

- [Webpack ê³µì‹ ë¬¸ì„œ](https://webpack.js.org/contribute/writers-guide/)
- [Webpack ë¹„ê³µì‹ ë¬¸ì„œ ì¶”ì²œ](https://joshua1988.github.io/webpack-guide/guide.html) : Webpack ì˜ í•µì‹¬ ê°œë…ì´ ì˜ ì„¤ëª…ë˜ì–´ ìˆë‹¤.
- [Webpack, Babel ì„¤ì • Boiler-plate (ê°•ì‚¬ ì‘ì„±)](https://github.com/ibare/tech-learning-3rd-webpack)

- [Redux Saga ì •ë¦¬ ë¸”ë¡œê·¸ ì°¸ì¡°](https://medium.com/@simsimjae/%EB%A6%AC%EB%8D%95%EC%8A%A4-%EC%82%AC%EA%B0%80-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-8e573de9786e)
